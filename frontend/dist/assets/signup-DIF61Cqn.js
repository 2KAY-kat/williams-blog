import{s as g,B as y}from"./utils-CTkCsTWQ.js";let i=!0;function f(n){if(n.length<6)return"weak";const o=/[A-Z]/.test(n),r=/[a-z]/.test(n),s=/\d/.test(n),c=/[!@#$~`?%^&*]/.test(n),a=o+r+s+c;return a>=4?"strong":a>=2?"medium":"weak"}function w(){const n=document.getElementById("password"),o=document.getElementById("confirm-password"),r=document.querySelector(".password-match-icon"),s=document.querySelector(".password-mismatch-icon");if(!n||!o||!r||!s)return;const c=n.value,a=o.value;if(c===""||a===""){r.style.display="none",s.style.display="none";return}c===a?(r.style.display="inline-block",s.style.display="none"):(r.style.display="none",s.style.display="inline-block")}window.checkPasswordMatch=w;document.addEventListener("DOMContentLoaded",function(){const n=document.getElementById("auth-toggle-link"),o=document.getElementById("form-subtitle"),s=document.getElementById("auth-button")?.querySelector(".btn-text"),c=document.querySelectorAll(".signup-field"),a=document.getElementById("toggle-prompt");function l(){i?(o.textContent="Welcome back, to The GrowthMinds Blog",s.textContent="Sign in",n.textContent="Signup",a.textContent="Don't have an account?",c.forEach(e=>e.style.display="none"),document.querySelector('[name="name"]')?.removeAttribute("required"),document.getElementById("confirm-password")?.removeAttribute("required")):(o.textContent="Sign up to The GrowthMinds Blog",s.textContent="Sign up",n.textContent="Signin",a.textContent="Already have an account?",c.forEach(e=>e.style.display="flex"),document.querySelector('[name="name"]')?.setAttribute("required","required"),document.getElementById("confirm-password")?.setAttribute("required","required")),i=!i}n?.addEventListener("click",e=>{e.preventDefault(),l()}),document.querySelectorAll(".toggle-password").forEach(e=>{e.style.display="none";const t=e.closest(".input-group")?.querySelector(".password-input");t&&(e.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),t.type=t.type==="password"?"text":"password",e.classList.toggle("fa-eye-slash"),e.classList.toggle("fa-eye")}),t.addEventListener("focus",()=>e.style.display="block"),t.addEventListener("blur",()=>{t.value===""&&(e.style.display="none")}),t.addEventListener("input",()=>{e.style.display=t.value.length>0?"block":"none"}))}),document.getElementById("password")?.addEventListener("input",function(){const e=document.querySelector(".strength-meter"),d=document.querySelector(".strength-text");if(e&&d){const t=f(this.value);e.className="strength-meter "+t,d.textContent=t.charAt(0).toUpperCase()+t.slice(1)}})});document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("auth-form"),o=document.getElementById("auth-button"),r=o.querySelector(".btn-text"),s=o.querySelector(".btn-spinner");n&&n.addEventListener("submit",async c=>{c.preventDefault(),o.disabled=!0,r.textContent=i?"Signing up...":"Logging in...",s.style.display="flex";const a=new FormData(n),l=Object.fromEntries(a.entries());let p=i?`${y}/auth/register`:`${y}/auth/login`;if(i&&l.password!==l.confirm_password){g("Passwords do not match.","error"),m();return}i||(delete l.name,delete l.confirm_password);try{const e=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),d=await e.text();console.log("Raw response:",d);let t;try{t=JSON.parse(d)}catch{throw new Error("Invalid JSON from server.")}if(e.ok)localStorage.setItem("auth_token",t.token),g(`${i?"Registration":"Login"} successful! Redirecting to dashboard...`,"success"),setTimeout(()=>{window.location.href="../admin/dashboard.html"},1200);else{const u=i?"registration":"login",h=t.error||t.message||"Unknown error";g(`Failed to ${u}: ${h}`,"error"),m()}}catch(e){console.error("Auth error:",e),g(`Network error: ${e.message}`,"error"),m()}function m(){o.disabled=!1,r.textContent=i?"Sign up":"Sign in",s.style.display="none"}})});
